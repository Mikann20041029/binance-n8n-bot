{
  "name": "Binance Automation",
  "nodes": [
    {
      "id": "start",
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        100,
        300
      ],
      "parameters": {}
    },
    {
      "id": "fetchSymbols",
      "name": "Symbols List",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        300,
        300
      ],
      "parameters": {
        "jsCode": "const symbols = ['BTCUSDT','ETHUSDT','BNBUSDT','SOLUSDT','XRPUSDT','ADAUSDT','DOGEUSDT','AVAXUSDT','LINKUSDT','MATICUSDT','TRXUSDT','DOTUSDT'];\nreturn symbols.map(symbol => ({ json: { symbol } }));"
      }
    },
    {
      "id": "splitInBatches",
      "name": "Split In Batches",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 1,
      "position": [
        500,
        300
      ],
      "parameters": {
        "batchSize": 1
      }
    },
    {
      "id": "binancePrice",
      "name": "Binance Price",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        100
      ],
      "parameters": {
        "resource": "ticker",
        "operation": "price",
        "symbol": "={{$json.symbol}}"
      }
    },
    {
      "id": "binanceCandles1m",
      "name": "Binance Candles 1m",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        200
      ],
      "parameters": {
        "resource": "candlestick",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "interval": "1m",
        "limit": 100
      }
    },
    {
      "id": "binanceCandles5m",
      "name": "Binance Candles 5m",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        300
      ],
      "parameters": {
        "resource": "candlestick",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "interval": "5m",
        "limit": 100
      }
    },
    {
      "id": "binanceCandles15m",
      "name": "Binance Candles 15m",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        400
      ],
      "parameters": {
        "resource": "candlestick",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "interval": "15m",
        "limit": 100
      }
    },
    {
      "id": "binanceCandles1h",
      "name": "Binance Candles 1h",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        500
      ],
      "parameters": {
        "resource": "candlestick",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "interval": "1h",
        "limit": 100
      }
    },
    {
      "id": "binanceCandles4h",
      "name": "Binance Candles 4h",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        600
      ],
      "parameters": {
        "resource": "candlestick",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "interval": "4h",
        "limit": 100
      }
    },
    {
      "id": "binanceCandles1d",
      "name": "Binance Candles 1d",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        700,
        700
      ],
      "parameters": {
        "resource": "candlestick",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "interval": "1d",
        "limit": 100
      }
    },
    {
      "id": "binanceOrderBook",
      "name": "Binance Order Book",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        900,
        300
      ],
      "parameters": {
        "resource": "orderBook",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "depth": 20
      }
    },
    {
      "id": "binanceTrades",
      "name": "Binance Trades",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        900,
        500
      ],
      "parameters": {
        "resource": "trade",
        "operation": "get",
        "symbol": "={{$json.symbol}}",
        "limit": 100
      }
    },
    {
      "id": "mergeData",
      "name": "Merge Data",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2,
      "position": [
        1100,
        300
      ],
      "parameters": {
        "mode": "combineByPosition"
      }
    },
    {
      "id": "computeIndicators",
      "name": "Compute Indicators",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1300,
        300
      ],
      "parameters": {
        "jsCode": "const data = $input.all();\nconst merged = {};\ndata.forEach(item => Object.assign(merged, item.json));\n// Placeholder for indicator calculations\nmerged.atr = 0.01;\nmerged.volatility = 0.02;\nmerged.volumeSpike = false;\nmerged.imbalance = 0.05;\nreturn [{ json: merged }];"
      }
    },
    {
      "id": "gateCheck",
      "name": "Gate Check",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1500,
        300
      ],
      "parameters": {
        "jsCode": "const item = $input.first().json;\nif (!item.orderBook || !item.trades) {\n  item.gatePass = false;\n  item.reason = 'Missing orderBook or trades';\n} else {\n  item.gatePass = true;\n}\nreturn [{ json: item }];"
      }
    },
    {
      "id": "scoreCalculation",
      "name": "Score Calculation",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1700,
        300
      ],
      "parameters": {
        "jsCode": "const item = $input.first().json;\nif (!item.gatePass) {\n  item.decision = 'NO_TRADE';\n  return [{ json: item }];\n}\nitem.directionScore = 0.6;\nitem.timingScore = 0.7;\nitem.flowScore = 0.5;\nitem.positionScore = 0.8;\nitem.totalScore = item.directionScore + item.timingScore + item.flowScore + item.positionScore;\nitem.decision = item.totalScore > 2.5 ? 'BUY' : 'NO_TRADE';\nreturn [{ json: item }];"
      }
    },
    {
      "id": "decisionIf",
      "name": "Decision IF",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1900,
        300
      ],
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.decision}}",
              "operation": "equals",
              "value2": "BUY"
            }
          ]
        }
      }
    },
    {
      "id": "placeOrderBuy",
      "name": "Place Order Buy",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        2100,
        200
      ],
      "parameters": {
        "resource": "order",
        "operation": "place",
        "symbol": "={{$json.symbol}}",
        "side": "buy",
        "orderType": "market",
        "baseQuantity": 0.001,
        "additionalFields": {}
      }
    },
    {
      "id": "placeOrderSell",
      "name": "Place Order Sell",
      "type": "n8n-nodes-base.binance",
      "typeVersion": 2,
      "position": [
        2100,
        400
      ],
      "parameters": {
        "resource": "order",
        "operation": "place",
        "symbol": "={{$json.symbol}}",
        "side": "sell",
        "orderType": "market",
        "baseQuantity": 0.001,
        "additionalFields": {}
      }
    }
  ],
  "connections": {
    "start": {
      "main": [
        [
          {
            "node": "fetchSymbols",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "fetchSymbols": {
      "main": [
        [
          {
            "node": "splitInBatches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "splitInBatches": {
      "main": [
        [
          {
            "node": "binancePrice",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceCandles1m",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceCandles5m",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceCandles15m",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceCandles1h",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceCandles4h",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceCandles1d",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceOrderBook",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "binanceTrades",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "binancePrice": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "binanceCandles1m": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "binanceCandles5m": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "binanceCandles15m": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "binanceCandles1h": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "binanceCandles4h": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 5
          }
        ]
      ]
    },
    "binanceCandles1d": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 6
          }
        ]
      ]
    },
    "binanceOrderBook": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 7
          }
        ]
      ]
    },
    "binanceTrades": {
      "main": [
        [
          {
            "node": "mergeData",
            "type": "main",
            "index": 8
          }
        ]
      ]
    },
    "mergeData": {
      "main": [
        [
          {
            "node": "computeIndicators",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "computeIndicators": {
      "main": [
        [
          {
            "node": "gateCheck",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "gateCheck": {
      "main": [
        [
          {
            "node": "scoreCalculation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "scoreCalculation": {
      "main": [
        [
          {
            "node": "decisionIf",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "decisionIf": {
      "main": [
        [
          {
            "node": "placeOrderBuy",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "placeOrderSell",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}
